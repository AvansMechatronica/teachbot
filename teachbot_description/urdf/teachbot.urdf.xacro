<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="teachbot">

  <!-- ====== Global settings ====== -->
  <xacro:property name="S" value="1.0"/> <!-- mm->m; set to 1.0 if meters -->
  <xacro:arg name="base_link" default="world"/>
  <xacro:arg name="joint_prefix" default="teachbot/"/>
  <xacro:property name="base_link_name" value="$(arg base_link)"/>
  <xacro:property name="joint_prefix_value" value="$(arg joint_prefix)"/>

  <!-- ====== Initial joint positions (in radians) ====== -->
  <xacro:property name="shoulder_pan_init" value="1.5708"/> <!-- 1/2 pi -->
  <xacro:property name="shoulder_lift_init" value="-1.5708"/> <!-- -1/2 pi -->
  <xacro:property name="elbow_init" value="4.7124"/> <!-- 1.5 pi -->
  <xacro:property name="wrist_1_init" value="0.0"/>
  <xacro:property name="wrist_2_init" value="4.7124"/> <!-- 1.5 pi -->
  <xacro:property name="wrist_3_init" value="4.7124"/> <!-- 1.5 pi -->

  <!-- ====== A simple macro: one visual mesh link ====== -->
  <xacro:macro name="mesh_link" params="name">
    <link name="${name}">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://teachbot_description/meshes/${name}.dae"
                scale="${S} ${S} ${S}"/>
        </geometry>
      </visual>

      <!-- Optional: add collision primitives per link here later -->
      <!--
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <box size="0.1 0.1 0.1"/>
        </geometry>
      </collision>
      -->
    </link>
  </xacro:macro>

  <!-- ====== Frames ====== -->
  <link name="world"/>

  <!-- ====== Links (visual meshes) ====== -->
  <xacro:mesh_link name="link_1"/>
  <xacro:mesh_link name="link_2"/>
  <xacro:mesh_link name="link_3"/>
  <xacro:mesh_link name="link_4"/>
  <xacro:mesh_link name="link_5"/>
  <xacro:mesh_link name="link_6"/>
  <xacro:mesh_link name="link_7"/>
  <xacro:mesh_link name="link_8"/>

  <!-- ====== Joints ====== -->
  <joint name="world_to_link_1" type="fixed">
    <parent link="${base_link_name}"/>
    <child link="link_1"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <!-- Fill in origins/axes to match your CAD frames -->
  <joint name="${joint_prefix_value}shoulder_pan_joint" type="revolute">
    <parent link="link_1"/>
    <child link="link_2"/>
    <origin xyz="0 0 0.156875" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-3.1416" upper="3.1416" effort="10" velocity="1.0"/>
  </joint>

  <joint name="${joint_prefix_value}shoulder_lift_joint" type="revolute">
    <parent link="link_2"/>
    <child link="link_3"/>
    <origin xyz="0 0 0" rpy="-1.5708 0 0"/>
    <axis xyz="-1 0 0"/>
    <limit lower="-3.1416" upper="3.1416" effort="10" velocity="1.0"/>
  </joint>

  <joint name="${joint_prefix_value}elbow_joint" type="revolute">
    <parent link="link_3"/>
    <child link="link_4"/>
    <origin xyz="0 0 0.249" rpy="4.7124 0 0"/>
    <axis xyz="-1 0 0"/>
    <limit lower="-3.1416" upper="3.1416" effort="10" velocity="1.0"/>
  </joint>

  <joint name="${joint_prefix_value}wrist_1_joint" type="revolute">
    <parent link="link_4"/>
    <child link="link_5"/>
    <origin xyz="0 -0.227 0" rpy="3.1416 0 0"/>
    <axis xyz="-1 0 0"/>
    <limit lower="-3.1416" upper="3.1416" effort="10" velocity="1.0"/>
  </joint>

  <joint name="${joint_prefix_value}wrist_2_joint" type="revolute">
    <parent link="link_5"/>
    <child link="link_6"/>
    <origin xyz="-0.038375 0 0" rpy="0 0 1.5708"/>
    <axis xyz="0 0 1"/>
    <limit lower="-3.1416" upper="3.1416" effort="10" velocity="1.0"/>
  </joint>

  <joint name="${joint_prefix_value}wrist_3_joint" type="revolute">
    <parent link="link_6"/>
    <child link="link_7"/>
    <origin xyz="0 0 0.038375" rpy="0 -1.5708 0"/>
    <axis xyz="0 -1 0"/>
    <limit lower="-3.1416" upper="3.1416" effort="10" velocity="1.0"/>
  </joint>

  <joint name="dummy_joint" type="fixed">
    <parent link="link_7"/>
    <child link="link_8"/>
    <origin xyz="0 -0.119075 0.00193171" rpy="0 0 0"/>
    <axis xyz="1 0 0"/>
    <limit lower="0.0" upper="0.2618" effort="10" velocity="1.0"/>
  </joint>

</robot>
